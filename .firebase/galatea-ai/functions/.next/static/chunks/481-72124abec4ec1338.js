"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[481],{3481:function(e,t,a){a.r(t),a.d(t,{default:function(){return l}});var r=a(7437),s=a(2265),o=a(9376),n=a(8990),i=a(6910);function l(e){let{children:t}=e,a=(0,o.useRouter)(),{user:l,loading:c}=(0,n.a)(),[d,h]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{if(!c){if(!l){a.push("/sign-in");return}h(!1)}},[l,c,a]),c||d)?(0,r.jsx)("div",{className:"h-screen flex items-center justify-center bg-gradient-to-br from-ivory-100 via-rose-50 to-earth-100",children:(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-rose-600"}),(0,r.jsx)("div",{className:"text-2xl text-earth-800",children:"Loading..."})]})}):(0,r.jsxs)("div",{className:"h-screen w-screen flex overflow-hidden bg-gradient-to-br from-ivory-100 via-rose-50 to-earth-100 absolute top-0 left-0",children:[(0,r.jsx)(i.Z,{}),(0,r.jsx)("div",{className:"flex-1 flex flex-col h-full",children:(0,r.jsx)("main",{className:"flex-1 h-full overflow-auto",children:t})})]})}},8990:function(e,t,a){a.d(t,{AuthProvider:function(){return d},a:function(){return c}});var r=a(7437),s=a(2265),o=a(3301),n=a(9376),i=a(7293);let l=(0,s.createContext)({user:null,loading:!0,error:null,isAuthenticated:!1,signOut:async()=>{}}),c=()=>(0,s.useContext)(l),d=e=>{let{children:t}=e,[a,c]=(0,s.useState)(null),[d,h]=(0,s.useState)(!0),[u,m]=(0,s.useState)(null),g=(0,n.useRouter)(),f=(0,o.v0)(i.ZP),x=async()=>{try{console.log("Signing out from AuthContext..."),await (0,o.w7)(f),c(null),g.push("/")}catch(e){console.error("Error signing out:",e),m("Failed to sign out")}};return(0,s.useEffect)(()=>{console.log("Setting up auth state listener");let e=(0,o.Aj)(f,e=>{console.log("Auth state changed:",e?"Logged in as ".concat(e.displayName||e.email):"Not logged in"),e?c({uid:e.uid,email:e.email||"",emailVerified:e.emailVerified,displayName:e.displayName||"",isAnonymous:e.isAnonymous,photoURL:e.photoURL||"",providerData:e.providerData.map(e=>({providerId:e.providerId,uid:e.uid,displayName:e.displayName||"",email:e.email||"",phoneNumber:e.phoneNumber,photoURL:e.photoURL||""})),stsTokenManager:{refreshToken:e.refreshToken||"",accessToken:"",expirationTime:0},createdAt:"",lastLoginAt:"",apiKey:"",appName:f.app.name}):(console.log("No user detected, clearing user state"),c(null)),h(!1)},e=>{console.error("Auth state error:",e),m(e.message),h(!1)});return()=>e()},[f,g]),(0,r.jsx)(l.Provider,{value:{user:a,loading:d,error:u,isAuthenticated:!!a,signOut:x},children:t})}},6910:function(e,t,a){var r=a(7437),s=a(7648),o=a(9376),n=a(7692),i=a(2869),l=a(2265),c=a(8990),d=a(1211);t.Z=()=>{let e=(0,o.usePathname)(),{user:t,signOut:a}=(0,c.a)(),{matches:h,loading:u,fetchMatches:m,initialized:g}=(0,d.em)();(0,l.useEffect)(()=>{(null==t?void 0:t.uid)&&!g&&!u&&m(t.uid)},[null==t?void 0:t.uid,g,u,m]);let f=h.length,x=d.ZP.getUnreadCount(),p=async()=>{try{d.ZP.clearMatches(),await a()}catch(e){console.error("Error signing out:",e)}};return(0,r.jsxs)("div",{className:"hidden md:flex w-64 bg-white bg-opacity-90 shadow-md flex-col h-screen",children:[(0,r.jsxs)("div",{className:"p-6 flex-grow overflow-y-auto",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-earth-800 mb-4",children:"Navigation"}),(0,r.jsxs)("nav",{className:"space-y-2",children:[(0,r.jsxs)(s.default,{href:"/swipe",className:"flex items-center px-4 py-3 rounded-lg font-medium ".concat("/swipe"===e?"bg-rose-50 text-rose-600":"text-earth-600 hover:bg-rose-50 hover:text-rose-600"),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Discover Matches"]}),(0,r.jsxs)(s.default,{href:"/matches",className:"flex items-center px-4 py-3 rounded-lg font-medium ".concat("/matches"===e?"bg-rose-50 text-rose-600":"text-earth-600 hover:bg-rose-50 hover:text-rose-600"),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 00-6.364 0z"})}),"My Matches",f>0&&(0,r.jsx)("span",{className:"ml-auto bg-rose-100 text-rose-600 text-xs py-1 px-2 rounded-full",children:f})]}),(0,r.jsxs)(s.default,{href:"/profile",className:"flex items-center px-4 py-3 rounded-lg font-medium ".concat("/profile"===e?"bg-rose-50 text-rose-600":"text-earth-600 hover:bg-rose-50 hover:text-rose-600"),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"My Profile"]}),(0,r.jsxs)("div",{className:"pt-4 mt-4 border-t border-gray-200",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-earth-500 mb-2 px-4",children:"Match Stats"}),(0,r.jsxs)("div",{className:"bg-ivory-50 rounded-lg p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-sm text-earth-600",children:"New Matches"}),(0,r.jsx)("span",{className:"bg-rose-100 text-rose-600 text-xs py-1 px-2 rounded-full",children:f})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-earth-600",children:"Unread Messages"}),(0,r.jsx)("span",{className:"bg-rose-100 text-rose-600 text-xs py-1 px-2 rounded-full",children:x})]})]})]})]})]}),(0,r.jsx)("div",{className:"p-4 border-t border-gray-200 mt-auto",children:(0,r.jsxs)(i.z,{onClick:p,variant:"outline",className:"w-full flex items-center justify-center text-earth-600 hover:text-rose-600 hover:bg-rose-50 border-earth-200",children:[(0,r.jsx)(n.Z,{size:18,className:"mr-2"}),"Sign Out"]})})]})}},2869:function(e,t,a){a.d(t,{z:function(){return c}});var r=a(7437),s=a(2265),o=a(5293),n=a(535),i=a(4508);let l=(0,n.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-rose-600 text-ivory-100 hover:bg-rose-700",signIn:"bg-rose-600 text-ivory-100 hover:bg-rose-700",destructive:"bg-red-500 text-ivory-100 hover:bg-red-600",outline:"border border-earth-200 bg-ivory-100 hover:bg-earth-100 hover:text-earth-700",secondary:"bg-earth-200 text-earth-700 hover:bg-earth-300",ghost:"hover:bg-earth-100 hover:text-earth-700",link:"underline-offset-4 hover:underline text-rose-600"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:a,variant:s,size:n,asChild:c=!1,...d}=e,h=c?o.g7:"button";return(0,r.jsx)(h,{className:(0,i.cn)(l({variant:s,size:n,className:a})),ref:t,...d})});c.displayName="Button"},7293:function(e,t,a){var r=a(738),s=a(5978),o=a(62),n=a(6834);let i=(0,r.ZF)({apiKey:"AIzaSyBlw_fzjEs-NbOabJkHEpGbfBdDEt7RVvI",authDomain:"galatea-ai.firebaseapp.com",projectId:"galatea-ai",storageBucket:"galatea-ai.firebasestorage.app",messagingSenderId:"727737899444",appId:"1:727737899444:web:16152c4885a96302af7ae1",measurementId:"G-6ZQT56XSCV"});(0,s.ad)(i),(0,o.cF)(i),(0,n.IH)(i),t.ZP=i},4508:function(e,t,a){a.d(t,{cn:function(){return o}});var r=a(1994),s=a(3335);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}},1211:function(e,t,a){a.d(t,{em:function(){return o}});var r=a(3011),s=a(6885);let o=(0,r.U)()((0,s.tJ)((e,t)=>({matches:[],loading:!1,error:null,initialized:!1,fetchMatches:async t=>{try{e({loading:!0,error:null});let a=await fetch("/api/matches".concat(t?"?userId=".concat(t):""));if(!a.ok)throw Error("Failed to fetch matches: ".concat(a.status));let r=await a.json();return e({matches:r.matches,loading:!1,initialized:!0}),r.matches}catch(t){console.error("Error fetching matches:",t),e({error:t instanceof Error?t.message:"Failed to fetch matches",loading:!1})}},getMatchById:e=>t().matches.find(t=>t.id===e),updateMatch:(t,a)=>{e(e=>({matches:e.matches.map(e=>e.id===t?{...e,...a}:e)}))},clearMatches:()=>{e({matches:[],initialized:!1})},markMessageAsRead:t=>{e(e=>({matches:e.matches.map(e=>e.id===t&&e.lastMessage?{...e,lastMessage:{...e.lastMessage,read:!0}}:e)}))}}),{name:"galatea-matches",partialize:e=>({matches:e.matches})}));class n{static async getMatches(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{fetchMatches:a,initialized:r}=o.getState();return(t||!r)&&await a(e),o.getState().matches}static getMatch(e){return o.getState().getMatchById(e)}static getUnreadCount(){let{matches:e}=o.getState();return e.filter(e=>e.lastMessage&&!e.lastMessage.read).length}static markAsRead(e){o.getState().markMessageAsRead(e)}static clearMatches(){o.getState().clearMatches()}static hasMatches(){return o.getState().matches.length>0}}t.ZP=n}}]);