(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[760],{6274:function(e,t,a){Promise.resolve().then(a.bind(a,58))},58:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var r=a(7437),s=a(2265),n=a(9376),i=a(8990),l=a(2869),o=a(6070),c=a(3145),d=a(1211);function u(){let e=(0,n.useRouter)(),{user:t,loading:a}=(0,i.a)(),{matches:c,loading:u,fetchMatches:m}=(0,d.em)();return((0,s.useEffect)(()=>{if(!a){if(!t){e.push("/sign-in");return}m(t.uid)}},[t,a,e,m]),a||u)?(0,r.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-rose-600"}),(0,r.jsx)("div",{className:"text-2xl text-earth-800",children:"Loading matches..."})]})}):(0,r.jsxs)("div",{className:"h-full w-full p-6 overflow-y-auto",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-earth-800 mb-6",children:"My Matches"}),0===c.length?(0,r.jsxs)(o.Zb,{className:"p-8 text-center",children:[(0,r.jsx)("div",{className:"text-5xl mb-4",children:"\uD83D\uDC94"}),(0,r.jsx)("h2",{className:"text-2xl font-bold text-earth-800 mb-2",children:"No Matches Yet"}),(0,r.jsx)("p",{className:"text-earth-600 mb-6",children:"Keep swiping to find your perfect match!"}),(0,r.jsx)(l.z,{className:"bg-rose-500 hover:bg-rose-600 text-white",onClick:()=>e.push("/swipe"),children:"Discover Matches"})]}):(0,r.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:c.map(t=>(0,r.jsx)(h,{match:t,onOpenConversation:t=>{d.ZP.markAsRead(t),e.push("/messages/".concat(t))}},t.id))})]})}let h=e=>{let{match:t,onOpenConversation:a}=e;return(0,r.jsxs)(o.Zb,{className:"overflow-hidden hover:shadow-lg transition-shadow",children:[(0,r.jsx)("div",{className:"relative h-48 bg-gray-100",children:(0,r.jsx)(c.default,{src:t.profile.images[0],alt:t.profile.name,fill:!0,style:{objectFit:"cover"}})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-earth-800",children:[t.profile.name,", ",t.profile.age]}),t.lastMessage&&!t.lastMessage.read&&(0,r.jsx)("span",{className:"bg-rose-500 rounded-full w-3 h-3"})]}),t.profile.location&&(0,r.jsx)("p",{className:"text-sm text-earth-600 mb-2",children:t.profile.location}),t.lastMessage&&(0,r.jsxs)("div",{className:"border-t border-gray-100 pt-2 mt-2",children:[(0,r.jsx)("p",{className:"text-sm text-earth-700 font-medium truncate",children:t.lastMessage.text}),(0,r.jsx)("p",{className:"text-xs text-earth-500",children:t.lastMessage.timestamp})]}),(0,r.jsx)(l.z,{className:"w-full mt-4 bg-rose-500 hover:bg-rose-600 text-white",onClick:()=>a(t.id),children:"Message"})]})]},t.id)}},8990:function(e,t,a){"use strict";a.d(t,{AuthProvider:function(){return d},a:function(){return c}});var r=a(7437),s=a(2265),n=a(3301),i=a(9376),l=a(7293);let o=(0,s.createContext)({user:null,loading:!0,error:null,isAuthenticated:!1,signOut:async()=>{}}),c=()=>(0,s.useContext)(o),d=e=>{let{children:t}=e,[a,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!0),[h,m]=(0,s.useState)(null),f=(0,i.useRouter)(),g=(0,n.v0)(l.ZP),p=async()=>{try{console.log("Signing out from AuthContext..."),await (0,n.w7)(g),c(null),f.push("/")}catch(e){console.error("Error signing out:",e),m("Failed to sign out")}};return(0,s.useEffect)(()=>{console.log("Setting up auth state listener");let e=(0,n.Aj)(g,e=>{console.log("Auth state changed:",e?"Logged in as ".concat(e.displayName||e.email):"Not logged in"),e?c({uid:e.uid,email:e.email||"",emailVerified:e.emailVerified,displayName:e.displayName||"",isAnonymous:e.isAnonymous,photoURL:e.photoURL||"",providerData:e.providerData.map(e=>({providerId:e.providerId,uid:e.uid,displayName:e.displayName||"",email:e.email||"",phoneNumber:e.phoneNumber,photoURL:e.photoURL||""})),stsTokenManager:{refreshToken:e.refreshToken||"",accessToken:"",expirationTime:0},createdAt:"",lastLoginAt:"",apiKey:"",appName:g.app.name}):(console.log("No user detected, clearing user state"),c(null)),u(!1)},e=>{console.error("Auth state error:",e),m(e.message),u(!1)});return()=>e()},[g,f]),(0,r.jsx)(o.Provider,{value:{user:a,loading:d,error:h,isAuthenticated:!!a,signOut:p},children:t})}},2869:function(e,t,a){"use strict";a.d(t,{z:function(){return c}});var r=a(7437),s=a(2265),n=a(5293),i=a(535),l=a(4508);let o=(0,i.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-rose-600 text-ivory-100 hover:bg-rose-700",signIn:"bg-rose-600 text-ivory-100 hover:bg-rose-700",destructive:"bg-red-500 text-ivory-100 hover:bg-red-600",outline:"border border-earth-200 bg-ivory-100 hover:bg-earth-100 hover:text-earth-700",secondary:"bg-earth-200 text-earth-700 hover:bg-earth-300",ghost:"hover:bg-earth-100 hover:text-earth-700",link:"underline-offset-4 hover:underline text-rose-600"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:a,variant:s,size:i,asChild:c=!1,...d}=e,u=c?n.g7:"button";return(0,r.jsx)(u,{className:(0,l.cn)(o({variant:s,size:i,className:a})),ref:t,...d})});c.displayName="Button"},6070:function(e,t,a){"use strict";a.d(t,{Zb:function(){return i}});var r=a(7437),s=a(2265),n=a(4508);let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border border-earth-200 bg-ivory-100 text-earth-800 shadow-sm",a),...s})});i.displayName="Card",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})}).displayName="CardHeader",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})}).displayName="CardTitle",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-earth-600",a),...s})}).displayName="CardDescription",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})}).displayName="CardContent",s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})}).displayName="CardFooter"},7293:function(e,t,a){"use strict";var r=a(738),s=a(5978),n=a(62),i=a(6834);let l=(0,r.ZF)({apiKey:"AIzaSyBlw_fzjEs-NbOabJkHEpGbfBdDEt7RVvI",authDomain:"galatea-ai.firebaseapp.com",projectId:"galatea-ai",storageBucket:"galatea-ai.firebasestorage.app",messagingSenderId:"727737899444",appId:"1:727737899444:web:16152c4885a96302af7ae1",measurementId:"G-6ZQT56XSCV"});(0,s.ad)(l),(0,n.cF)(l),(0,i.IH)(l),t.ZP=l},4508:function(e,t,a){"use strict";a.d(t,{cn:function(){return n}});var r=a(1994),s=a(3335);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}},1211:function(e,t,a){"use strict";a.d(t,{em:function(){return n}});var r=a(3011),s=a(6885);let n=(0,r.U)()((0,s.tJ)((e,t)=>({matches:[],loading:!1,error:null,initialized:!1,fetchMatches:async t=>{try{e({loading:!0,error:null});let a=await fetch("/api/matches".concat(t?"?userId=".concat(t):""));if(!a.ok)throw Error("Failed to fetch matches: ".concat(a.status));let r=await a.json();return e({matches:r.matches,loading:!1,initialized:!0}),r.matches}catch(t){console.error("Error fetching matches:",t),e({error:t instanceof Error?t.message:"Failed to fetch matches",loading:!1})}},getMatchById:e=>t().matches.find(t=>t.id===e),updateMatch:(t,a)=>{e(e=>({matches:e.matches.map(e=>e.id===t?{...e,...a}:e)}))},clearMatches:()=>{e({matches:[],initialized:!1})},markMessageAsRead:t=>{e(e=>({matches:e.matches.map(e=>e.id===t&&e.lastMessage?{...e,lastMessage:{...e.lastMessage,read:!0}}:e)}))}}),{name:"galatea-matches",partialize:e=>({matches:e.matches})}));class i{static async getMatches(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{fetchMatches:a,initialized:r}=n.getState();return(t||!r)&&await a(e),n.getState().matches}static getMatch(e){return n.getState().getMatchById(e)}static getUnreadCount(){let{matches:e}=n.getState();return e.filter(e=>e.lastMessage&&!e.lastMessage.read).length}static markAsRead(e){n.getState().markMessageAsRead(e)}static clearMatches(){n.getState().clearMatches()}static hasMatches(){return n.getState().matches.length>0}}t.ZP=i},6885:function(e,t,a){"use strict";a.d(t,{tJ:function(){return s}});let r=e=>t=>{try{let a=e(t);if(a instanceof Promise)return a;return{then:e=>r(e)(a),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>r(t)(e)}}},s=(e,t)=>(a,s,n)=>{let i,l={storage:function(e,t){let a;try{a=e()}catch(e){return}return{getItem:e=>{var t;let r=e=>null===e?null:JSON.parse(e,void 0),s=null!=(t=a.getItem(e))?t:null;return s instanceof Promise?s.then(r):r(s)},setItem:(e,t)=>a.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>a.removeItem(e)}}(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},o=!1,c=new Set,d=new Set,u=l.storage;if(!u)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),a(...e)},s,n);let h=()=>{let e=l.partialize({...s()});return u.setItem(l.name,{state:e,version:l.version})},m=n.setState;n.setState=(e,t)=>{m(e,t),h()};let f=e((...e)=>{a(...e),h()},s,n);n.getInitialState=()=>f;let g=()=>{var e,t;if(!u)return;o=!1,c.forEach(e=>{var t;return e(null!=(t=s())?t:f)});let n=(null==(t=l.onRehydrateStorage)?void 0:t.call(l,null!=(e=s())?e:f))||void 0;return r(u.getItem.bind(u))(l.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===l.version)return[!1,e.state];if(l.migrate){let t=l.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;let[r,n]=e;if(a(i=l.merge(n,null!=(t=s())?t:f),!0),r)return h()}).then(()=>{null==n||n(i,void 0),i=s(),o=!0,d.forEach(e=>e(i))}).catch(e=>{null==n||n(void 0,e)})};return n.persist={setOptions:e=>{l={...l,...e},e.storage&&(u=e.storage)},clearStorage:()=>{null==u||u.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>g(),hasHydrated:()=>o,onHydrate:e=>(c.add(e),()=>{c.delete(e)}),onFinishHydration:e=>(d.add(e),()=>{d.delete(e)})},l.skipHydration||g(),i||f}},3011:function(e,t,a){"use strict";a.d(t,{U:function(){return o}});var r=a(2265);let s=e=>{let t;let a=new Set,r=(e,r)=>{let s="function"==typeof e?e(t):e;if(!Object.is(s,t)){let e=t;t=(null!=r?r:"object"!=typeof s||null===s)?s:Object.assign({},t,s),a.forEach(a=>a(t,e))}},s=()=>t,n={setState:r,getState:s,getInitialState:()=>i,subscribe:e=>(a.add(e),()=>a.delete(e))},i=t=e(r,s,n);return n},n=e=>e?s(e):s,i=e=>e,l=e=>{let t=n(e),a=e=>(function(e,t=i){let a=r.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return r.useDebugValue(a),a})(t,e);return Object.assign(a,t),a},o=e=>e?l(e):l}},function(e){e.O(0,[358,657,53,50,145,971,117,744],function(){return e(e.s=6274)}),_N_E=e.O()}]);